#!/bin/bash

die() {
  echo >&2 "$@"
  exit 1
}

if [ $# -ne 2 ]; then
  die "usage: $0 dir1 dir2"
fi

diff -rq "$@" | awk '

/^Files / {
  print "vimdiff", $2, $4
}

/^Only in/ {
  path = $3
  sub(/:$/, "", path)
  print "vimdiff _", path "/" $4
}

' | sort

